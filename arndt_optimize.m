clc
clear all;

b0(1) = 10e-3;
b0(2) = 10e-3;
b0(3) = 9e-3;
b0(4) = 8e-3;
b0(5) = 8e-3;
b0(6) = 7e-3;
b0(7) = 6e-3;
b0(8) = 6e-3;
b0(9) = 5e-3;
b0(10)= 5e-3;
b0(11)= 4e-3;
b0(12)= 4e-3;
b0(13)= 4e-3;
b0(14)= 4e-3;
b0(15)= 4e-3;
b0(16)= 3e-3;
b0(17)= 3e-3;
b0(18)= 2e-3;
b0(19)= 1e-3;
b0(20)= 0.1e-3;
b0(21)= 11e-3;


%-------------------------------------------------------------------------%
%Distribucion de Taylor Teorica,  SLL=30dB, n_=7
A=[40.0173   39.6844   39.0521   38.1584   37.0171   35.6173   33.9545   32.0634   30.0176   27.8902   25.7070   23.4396   21.0569   18.6039   16.2431   14.2140   12.7217   11.8276   11.4199   11.2941];
% Dist de Potencias de Taylor
P=A.^2;
P=P/sum(P);
P=sqrt(P);

options= optimset('MaxFunEvals',1e7);
lsqnonlin(@arndtfun,b0,zeros(1,21),15*ones(1,21),options)

